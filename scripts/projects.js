const projectInfo = [
    {
        imgSrc: "images/lgts/lgts-screen.jpg",
        name: "Little Goody Two Shoes",
        modalIFrameURL:
            "https://www.youtube.com/embed/7zJnQvDRzO0?si=ILmvR_KnQh1angem",
        skills: ["csharp", "unity", "xbox"],
        descriptionParagaphs: [
            `Little Goody Two Shoes is a video game
        that includes elements of anime-inspired
        role-playing, adventure, and horror
        games. Players control a girl who
        attempts to avoid horrific monsters in
        enchanted woods while trying to find a
        way to escape her mundane life.`,
            `This game is developed by AstralShift
        and published by Square Enix Collective.
        It is currently avaialble for PC, PS5,
        XBOX, and Nintendo Switch. I was part of
        a vendor (Joydrop) that assisted with
        development in porting to consoles.`,
            `I worked primariy with porting to Xbox
        console. I helped with various console
        specific issues and UI programming to
        make sure it adapts to the controller
        scheme. I was also apart of the team to
        address and fix bugs from live testing
        to make sure we met the release
        deadline.`,
        ],
        actionButtons: [
            {
                text: "View Game",
                url: "https://little-goody-two-shoes.square-enix-games.com/en-us/",
            },
        ],
    },
    {
        imgSrc: "images/cover-me/coverme-screen.png",
        name: "Cover Me Pro",
        modalImgSrc: "images/cover-me/cover-me-logo.png",
        skills: ["react", "typescript", "material-ui", "firebase"],
        descriptionParagaphs: [
            `Cover Me Pro is a work scheduling web
            application that allows managers to
            effectively schedule their staff's
            shifts. This also alows employees to
            view and manager thier own shifts. They
            are able to trade with eachother, or
            request vacation/sick leave. This
            application also handle overtime
            callouts by utiling text notifcations to
            all eligible employees.`,
            `I was hired for designing all user
            flow/features. These are developed using
            React, TypeScript, and Material UI. All
            server side logic utlize firebase cloud
            functions that handles authentication,
            database, and file storage.`,
            `I am now also mentoring another developer 
            on this project to help with various task and 
            teach them along the way. It has been a great experience 
            for them and myself to be able to provide my knoweldge and 
            experience as they begin their career.`,
        ],
        actionButtons: [
            {
                text: "Learn More",
                url: "https://covermepro.com/",
            },
        ],
    },
    {
        imgSrc: "images/pot/pot.jpg",
        name: "Path of Titans",
        modalImgSrc: "images/pot/pot-logo.png",
        skills: ["cplusplus", "ue4"],
        descriptionParagaphs: [
            `Path of Titans is a MMO Survival game
            where you play as Dinosaurs in
            prehistoric times. Complete quest,
            challenge other players, and grow your
            dino from a youngling to a roaring
            adult!`,
            `This game is being develop by Alderon
            Games in Unreal Engine 5. I was part of
            a third party team (Joydrop) who joined
            in to assist them in creating major
            updates to the game. These updates
            included new flying and swimming
            dinosaurs, brand new combat and
            abilites, and more quest updates.`,
            `My noteable work was expanding on their
            combat system to implement Area of
            Effect attacks and other additional
            abilites. I also assisted in some
            optimization issues and a handful of
            bugs.`,
        ],
        actionButtons: [
            {
                text: "View Game",
                url: "https://pathoftitans.com/",
            },
        ],
    },
    {
        imgSrc: "images/rocket-recover/RocketRecover.gif",
        name: "Rocket Recover",
        modalImgSrc: "images/rocket-recover/poster-rr.png",
        skills: ["csharp", "unity", "google-play", "ios"],
        descriptionParagaphs: [
            `Rocket Recover is an immersive mobile game 
            designed for Android and iOS platforms released under Cat Splat Studios.
            The game challenges players to navigate through obstacles 
            with a selection of ships, each boasting unique stats 
            and powers, enhancing the pursuit of high scores. 
            Key features include customizable environments, and integrated 
            services like leaderboards for competitive play and ads for 
            monetization.`,
            `This project represents a significant milestone in my career as it was my first attempt at 
            designing and developing a game from start to finish. Although no 
            longer available on the app stores, Rocket Recover's development 
            process showcases my comprehensive skill set in mobile game development.`,
        ],
        actionButtons: [
            {
                text: "View Gameplay",
                url: "https://youtu.be/6MBp4RPGWVM",
            },
            {
                text: "Github Repo",
                url: "https://github.com/Cat-Splat-Studios/Project_ShipJump",
            },
        ],
    },
    {
        imgSrc: "images/chatnonymous/screenshot.png",
        name: "Chatnonymous",
        modalImgSrc: "images/chatnonymous/chatnonymous.png",
        skills: ["javascript", "react", "material-ui", "node-js"],
        descriptionParagaphs: [
            `Chatnonymous is a chat web application
            that allows users to communicate
            anonymously. This was design to create
            an environment where people can share
            their thoughts together without the
            concern of identity attached to the
            conversation. This allows discussions to
            happen at the clearest level so everyone
            in that environment can comprehend and
            understand without judgment.`,
            `I develop this app after graduating from
            Fanshawe College. There is both a client
            (React) and a server (NodeJS) that uses
            WebSocket communication. All information
            is handled on the server, meaning no
            data is stored on any database to keep
            all user's identities and conversation
            private and within the moment.`,
        ],
        actionButtons: [
            {
                text: "Try It Out",
                url: "https://chatnonymous.fly.dev/",
            },
            {
                text: "Github Repo",
                url: "https://github.com/Byte-Size-Coder/chatnonymous",
            },
        ],
    },
    {
        imgSrc: "images/westernVR/WesternVRShooterDemo.gif",
        name: "Western VR Shooter",
        modalImgSrc: "images/logo/bsc-logo-icon.png",
        skills: ["csharp", "unity", "meta"],
        descriptionParagaphs: [
            `I love the western theme! So I decided
            to use my Oculus to start developing
            some VR games! This is the first mini
            game in a mixture of western shooter
            theme. You have two revolvers and must
            shoot as many flying barrels as
            possible.`,
            `This uses Unity Open XR and XR
            interaction toolkit to establish the
            base mechanics, I added the gunplay
            ability for shooting and reloading.
            Plans are to add other mini games like a
            western standoff mini game and other
            ideas!`,
        ],
        actionButtons: [
            {
                text: "View Demo",
                url: "https://chatnonymous.fly.dev/",
            },
            {
                text: "Github Repo",
                url: "https://github.com/Byte-Size-Coder/chatnonymous",
            },
        ],
    },
    {
        imgSrc: "images/capstan-gate/capstan-doctor.jpg",
        name: "Capstan Gate",
        modalIFrameURL: "https://www.youtube.com/embed/jd_Ziwqyygg?start=5",
        skills: ["cplusplus", "ue4"],
        descriptionParagaphs: [
            `As the Technical Lead on "Capstan Gate," a first-person stealth 
            horror game developed as a final project at Toronto Film School, 
            I spearheaded a team of three programmers, guiding the project's 
            vision and maintaining development standards. My role extended 
            beyond leadership; I was directly involved in crafting the game's 
            core mechanics, and enemy AI, focusing on perception and pathfinding.`,
            `One of my key contributions was the creation of a nuanced coordinated 
            takedown mechanic, a feature that seamlessly integrated animations from 
            the first-person perspective, enhancing the game's realism and player 
            engagement. This technical feat not only elevated the gameplay experience 
            but also led me to produce a tutorial video, which has attracted over 
            2,000 views on YouTube, showcasing the mechanic's intricacies and my 
            ability to convey complex technical concepts to a wider audience.`,
        ],
        actionButtons: [
            {
                text: "View Game",
                url: "https://pathoftitans.com/",
            },
        ],
    },
];

var modal = document.getElementById("myModal");

let modalTitle = modal.querySelector(".modal-header__title");
let modalImage = modal.querySelector(".modal-header__image");

let modalSkills = modal.querySelector(".modal-header__skills");

let modalDescription = modal.querySelector(".modal-description");

let modalActions = modal.querySelector(".modal-actions");

let modalFeature = modal.querySelector(".modal-feature");

// Get the button that opens the modal
let overlays = document.getElementsByClassName("slide__overlay");

// Get the <span> element that closes the modal
let span = modal.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal
for (var i = 0; i < overlays.length; i++) {
    overlays[i].addEventListener("click", function () {
        modal.style.display = "block";
    });
}

// When the user clicks on <span> (x), close the modal
span.onclick = function () {
    modal.style.display = "none";
};

// When the user clicks anywhere outside of the modal, close it
window.onclick = function (event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
};

const slider = document.querySelector(".slider");

function addProjectSlide(project) {
    const slide = document.createElement("div");
    slide.className = "slide";

    const slideImage = document.createElement("img");
    slideImage.className = "slide__image";
    slideImage.src = project.imgSrc;
    slideImage.alt = project.name;

    const slideOverlay = document.createElement("div");
    slideOverlay.className = "slide__overlay";

    const sliderOverlayTitle = document.createElement("h2");
    sliderOverlayTitle.innerHTML = project.name;

    const sliderOverlayMoreInfo = document.createElement("button");
    sliderOverlayMoreInfo.className = "button-main overlay-info";
    sliderOverlayMoreInfo.innerHTML = "Click for more info";

    sliderOverlayMoreInfo.addEventListener("click", () => {
        OpenProjectModal(project);
    });

    slideOverlay.appendChild(sliderOverlayTitle);
    slideOverlay.appendChild(sliderOverlayMoreInfo);

    slide.appendChild(slideImage);
    slide.appendChild(slideOverlay);

    slider.appendChild(slide);
}

function OpenProjectModal(project) {
    modalTitle.innerHTML = project.name;

    if (project.modalImgSrc !== undefined) {
        modalImage.style.display = "block";
        modalImage.src = project.modalImgSrc;
    } else {
        modalImage.style.display = "none";
    }

    modalFeature.innerHTML = "";

    if (project.modalIFrameURL !== undefined) {
        const iframe = document.createElement("iframe");
        iframe.width = "300";
        iframe.height = "200";
        iframe.src = project.modalIFrameURL;
        iframe.allow =
            "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";

        modalFeature.appendChild(iframe);
    }

    modalSkills.innerHTML = "";

    for (skill of project.skills) {
        const skillIconImage = document.createElement("img");
        skillIconImage.src = "images/skill-logos/" + skill + ".png";
        skillIconImage.alt = skill;
        skillIconImage.width = 40;

        modalSkills.appendChild(skillIconImage);
    }

    modalDescription.innerHTML = "";

    for (paragraph of project.descriptionParagaphs) {
        const p = document.createElement("p");
        p.innerHTML = paragraph;

        modalDescription.appendChild(p);
    }

    modalActions.innerHTML = "";

    for (actionButton of project.actionButtons) {
        const actionBtn = document.createElement("button");
        actionBtn.className = "button-main";
        actionBtn.innerHTML = actionButton.text;
        actionBtn.onclick = function () {
            window.open(actionButton.url, "_blank").focus();
        };

        modalActions.append(actionBtn);
    }

    modal.style.display = "block";
}

for (let project of projectInfo) {
    addProjectSlide(project);
}

const buttonNext = document.createElement("button");
buttonNext.classList.add("btn");
buttonNext.classList.add("btn-next");
buttonNext.innerHTML = ">";

const buttonPrevious = document.createElement("button");
buttonPrevious.classList.add("btn");
buttonPrevious.classList.add("btn-prev");
buttonPrevious.innerHTML = "<";

slider.appendChild(buttonNext);
slider.appendChild(buttonPrevious);

// Select all slides
const slides = document.querySelectorAll(".slide");

// loop through slides and set each slides translateX property to index * 100%
slides.forEach((slide, indx) => {
    slide.style.transform = `translateX(${indx * 100}%)`;
});

// current slide counter
let curSlide = 0;
// maximum number of slides
let maxSlide = slides.length - 1;

function changeNextSlide() {
    if (curSlide === maxSlide) {
        curSlide = 0;
    } else {
        curSlide++;
    }

    //   move slide by -100%
    slides.forEach((slide, indx) => {
        slide.style.transform = `translateX(${100 * (indx - curSlide)}%)`;
    });
}

function changePrevSlide() {
    if (curSlide === 0) {
        curSlide = maxSlide;
    } else {
        curSlide--;
    }

    //   move slide by 100%
    slides.forEach((slide, indx) => {
        slide.style.transform = `translateX(${100 * (indx - curSlide)}%)`;
    });
}

// New drag functionality
let startX,
    isDragging = false;

const handleDragStart = (e) => {
    isDragging = true;
    startX = e.pageX;
};

const handleDragMove = (e) => {
    if (!isDragging) return;
    const dragDistance = e.pageX - startX;
    const slideDistance = dragDistance / slides[0].clientWidth;

    if (slideDistance > 0.25) {
        changePrevSlide();
        isDragging = false; // Prevent multiple slides on a long drag
    } else if (slideDistance < -0.25) {
        changeNextSlide();
        isDragging = false; // Prevent multiple slides on a long drag
    }
};

const handleDragEnd = () => {
    isDragging = false;
};

let autoSlideInterval = setInterval(changeNextSlide, 5000); // Change slide every 5 seconds

// Modify drag and click event handlers to clear the automatic slide change
const stopAutoSlide = () => {
    clearInterval(autoSlideInterval);
    // Remove this event listener to ensure this logic runs only once
    slides.forEach((slide) => {
        slide.removeEventListener("mousedown", stopAutoSlide);
        slide.removeEventListener("touchstart", stopAutoSlide);
    });

    nextSlide.removeEventListener("click", stopAutoSlide);
    prevSlide.removeEventListener("click", stopAutoSlide);
};

// Event listeners for dragging
slides.forEach((slide) => {
    slide.addEventListener("mousedown", handleDragStart);
    slide.addEventListener("mousemove", handleDragMove);
    slide.addEventListener("mouseup", handleDragEnd);
    slide.addEventListener("mouseleave", handleDragEnd); // End drag if the mouse leaves the slide area

    slide.addEventListener("mousedown", stopAutoSlide);
    slide.addEventListener("touchstart", stopAutoSlide);
});

// select next slide button
const nextSlide = document.querySelector(".btn-next");

// add event listener and navigation functionality
nextSlide.addEventListener("click", changeNextSlide);
nextSlide.addEventListener("click", stopAutoSlide);

// select prev slide button
const prevSlide = document.querySelector(".btn-prev");

// add event listener and navigation functionality
prevSlide.addEventListener("click", changePrevSlide);
prevSlide.addEventListener("click", stopAutoSlide);
